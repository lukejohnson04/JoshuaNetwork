{% load templatetags %}
<article class="media{% if comment.parent %} nested-comment {% else %} head-comment{% endif %}">
	{% if not comment.parent %}
		<div style="width:5em; margin-bottom: 0.75em;">
			<img class="rounded-circle comment-img" src="{{ comment.author.profile.image.url }}">
			<div style="display:flex; column-gap: 2px; margin-top: 0.5em;">
				<div style="width: 2em;">
					<a class="btn-upjoshua" href="javascript:void(0)" onclick="likePost(this, 1)" data-pk="{{ post.pk }}" data-likes="{{ post.total_likes }}">
						{% if karma == 1 %}
							<img src="/media/ui/upjoshua.png" name="upjoshua" style="width:100%">
						{% else %}
							<img src="/media/ui/upjoshua_empty.png" name="upjoshua" style="width:100%">
						{% endif %}
					</a>
				</div>
				<strong id="likeCount">25</strong>
				<div style="width: 2em">
					<a class="btn-downjoshua" href="javascript:void(0)" onclick="likePost(this, -1)" data-pk="{{ post.pk }}" data-likes="{{ post.total_likes }}">
						{% if karma == -1 %}
							<img src="/media/ui/downjoshua.png" name="downjoshua" style="width:100%">
						{% else %}
							<img src="/media/ui/downjoshua_empty.png" name="downjoshua" style="width:100%">				
						{% endif %}
					</a>
				</div>
			</div>
		</div>
	{% endif %}
	<div style="width: 100%; height: 100%; display: flex; flex-direction: column;">
		<div class="article-metadata">
			{% if comment.parent %}
				<img class="rounded-circle nested-reply-img" src="{{ comment.author.profile.image.url }}">
			{% endif %}
			<a class="mr-2" href="{% url 'user-posts' comment.author.username %}">{{ comment.author }}</a>
			<small class="text-muted">{{ comment.date_posted|date:"F d, Y" }}</small>
			{% if comment.author == user %}
				<a style="display:inline; float:right; font-size: 0.95em" href="javascript:void(0)" class="text-danger" onclick="deleteComment(this)" data-pk="{{ comment.pk }}">Delete</a>
			{% endif %}
		</div>
		<p style="margin-bottom: 0px; margin-left: 1em">{{ comment.content }}</p>
		<div class="form-outline reply-box" style="display:none;">
			{% csrf_token %}
			<textarea class="form-control" id="comment-field-{{ comment.pk }}" rows="4"></textarea>
			<button class="btn btn-outline-info" onclick="postComment(this)" data-pk="{{ comment.post.pk }}" parent-comment="{{ comment.pk }}">Post</button>
		</div>
		<div id="comment-replies-{{ comment.pk }}">
			{% for reply in comment.replies.all %}
				{% render_comment reply user %}
			{% endfor %}
		</div>
		<div style="width: 100%;">
			<a href="javascript:void(0)" style="float: right;" class="reply-btn text-muted btn-sm mt-1 mb-1" data-pk="{{ comment.pk }}">Reply</a>
		</div>
	</div>
</article>